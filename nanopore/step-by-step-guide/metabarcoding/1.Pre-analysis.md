## Preparations
We perform quality control using FastQC on our lab's Linux server or UGent HPC. You have to login into your own account, if you don't have one ask Zixia to creat one for you.

Install bioconda if it is not already installed on your system. It is specifically designed for the easy installation and management of bioinformatics softwares. You can follow the instructions at https://bioconda.github.io/user/install.html to install it.

Once bioconda is installed, open a terminal and activate the bioconda environment by running the command:

```
conda activate bioconda
```

## 1. Quality Control

### Using Guppy to do quality control based on .fast5 files

Install Guppy on your computer. Guppy is a software package developed by Oxford Nanopore Technologies for basecalling and quality control of raw sequencing data. It can be downloaded from the Oxford Nanopore website.

If you are using the lab server, we have Goppy installed for you already, otherwise you have to install yourselves.
<details>
  <summary>Click to see installation guide</summary>
  Here is the installation code provided by the ONT official: 

  ```
  sudo apt-get update
  sudo apt-get install wget lsb-release
  export PLATFORM=$(lsb_release -cs)
  wget -O- https://mirror.oxfordnanoportal.com/apt/ont-repo.pub | sudo apt-key add -
  echo "deb http://mirror.oxfordnanoportal.com/apt ${PLATFORM}-stable non-free" | sudo tee /etc/apt/sources.list.d/nanoporetech.sources.list
  sudo apt-get update
  apt-get install ont-guppy-cpu
  ```

  I personally had some problem with the installation from repo, so I downloaded the software from https://nanoporetech.com/downloads/guppy and installed manually:

  ```
  tar -xvzf ont-guppy*.tar.gz
  mv ont-guppy-cpu /opt/ont-guppy-cpu
  sudo chmod 2775 /opt/ont-guppy-cpu/bin
  chmod +x /opt/ont-guppy-cpu/bin/*
  ```
  
  Finally add this line into `/etc/profile`:
  
  ```
  export PATH="$PATH:/opt/ont-guppy-cpu/bin"
  ```
</details>

Put the `.fast5` files that you want to analyze in a single directory. Run FastQC on the .fast5 files using the following command, replace all the `INPUT_FILE_PATH` with your directory and choose reasonable thread numbers.

```
mkdir -p "INPUT_FILE_PATH/raw_qc"
ls INPUT_FILE_PATH/*.fast5 | xargs -n 1 -P 24 fastqc --quiet --outdir "INPUT_FILE_PATH/raw_qc/"
```

This command runs FastQC on all the .fast5 files in the directory and generates an HTML report for each file, to make the process much faster, we use xarg to do parallel computing. But it's not a good idea to go through the reports one by one, here we generate a single report from the FastQC results using MultiQC:

```
conda install -c bioconda multiqc
```

Navigate to the directory where the FastQC reports are stored, in our case `INPUT_FILE_PATH/raw_qc/`, then run the MultiQC:

```
cd INPUT_FILE_PATH/raw_qc
multiqc .
```

This will generate a single report summarizing the quality control results from all the FastQC reports in the current directory. To view the MultiQC report, open the file called `multiqc_report.html` in a web browser.

### Using PycoQC to do quality control based on sequencing_summary file

PycoQC is specifically designed for quality control of Nanopore sequencing data. Unlike FastQC, it uses the sequencing summary file generated by the basecalling software as the input data.

Install pycoQC using bioconda in Linux:

```
conda install -c bioconda pycoqc
```

Run pycoQC on the sequencing_summary.txt file to generate a report, the file name should be something like `sequencing_summary_FAM93703_1763f310_65bd5fda.txt`:

```
pycoQC -f sequencing_summary_FAM93703_1763f310_65bd5fda.txt -o report.html
```

This will generate a report named "report.html" in the current directory, containing the quality control results for your Nanopore sequencing data.
